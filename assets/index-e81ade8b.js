import{r as i,j as a}from"./index-3f2a1a41.js";const u=[{id:0,h:"10rem",bg:"rgb(105, 64, 231)"}],h={images:u};function g(o){const[t,s]=i.useState(o??[]),[l,d]=i.useState();return i.useEffect(()=>{const e=t.map(n=>({ref:n.ref,br:n.ref.current.getBoundingClientRect()}));l&&e&&l.forEach(n=>{const r=e.find(c=>c.ref.current===n.ref.current);if(r){const c=r.ref.current,f=n.br.left-r.br.left,m=n.br.top-r.br.top;c&&(f!==0||m!==0)&&(c.style.transform=`translate(${f}px, ${m}px)`,c.style.transition="transform 0s",requestAnimationFrame(()=>{c.style.transform="",c.style.transition="transform 500ms"}))}})},[t,l]),i.useEffect(()=>{if(t.every(e=>e.ref.current)){const e=t.map(n=>({ref:n.ref,br:n.ref.current.getBoundingClientRect()}));d(e)}},[t]),[t,s]}function y(){const[o,t]=g(h.images.map(e=>({...e,ref:i.createRef()}))),[s,l]=i.useState(!1),d=i.useCallback(()=>{if(s)return;l(!0);const e=Math.max(...o.map(r=>r.id)),n=[];for(let r=0;r<5;r++)n.push(p(e+r));setTimeout(()=>{l(!1),t([...o,...n])},1e3)},[o,s,t]);return i.useEffect(()=>{const e=document.querySelector(".scroller"),n=c=>{if(!(!e||e.scrollHeight<=e.clientHeight))for(const f of c)f.isIntersecting&&d()},r=new IntersectionObserver(n,{root:e,threshold:0});return r==null||r.observe(e==null?void 0:e.lastChild),()=>{r==null||r.unobserve(e==null?void 0:e.lastChild),r==null||r.disconnect()}},[o,s,d]),a.jsxs("div",{children:[a.jsx("p",{className:"text-center",children:"masonry in grid layout only implemented by firefox"}),a.jsxs("div",{className:"flex gap-x-4 justify-center my-6",children:[a.jsx("button",{type:"button",className:"bg-slate-700 rounded-full py-2 px-8 text-white",onClick:()=>{t(x(o))},children:"Randomize"}),a.jsx("button",{type:"button",className:"bg-red-500 rounded-full py-2 px-8 text-white",onClick:d,children:"Add 5"})]}),a.jsxs("div",{className:"scroller w-full max-h-[50rem] relative overflow-y-scroll bg-gray-400",children:[s&&a.jsx("div",{className:"sticky top-0 w-full h-12 leading-[3rem] backdrop-blur text-center text-white font-bold text-lg z-20",children:"Loading"}),a.jsx("div",{className:`scroller-item columns-3 sm:columns-7 gap-2 w-full rounded-md p-6 ${s?"mt-[-3rem]":""}`,children:o.map(e=>a.jsxs("div",{ref:e.ref,className:"flex justify-center items-center relative mb-2 hover:scale-110 hover:z-10 cursor-pointer",children:[a.jsx("div",{className:"absolute text-5xl font-bold text-white",children:e.id}),a.jsx("img",{className:"w-full aspect-video",style:{height:`${e.h}`,backgroundColor:`${e.bg}`}})]},e.id))}),a.jsx("div",{className:"w-full h-[1px]"})]})]})}function x(o){const t=[...o];for(let s=0;s<t.length-1;s++){const l=s+Math.floor(Math.random()*(t.length-s)),d=t[l];t[l]=t[s],t[s]=d}return t}function p(o){const t=`${Math.floor(Math.random()*11)+8}rem`,s=`rgb(${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)})`;return{id:o+1,h:t,bg:s,ref:i.createRef()}}export{y as default};
